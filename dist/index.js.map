{"version":3,"file":"index.js","names":[],"sources":["../src/migrations.ts"],"sourcesContent":["type FieldType = \"int\" | `varchar(${number})` | \"text\" | \"float\";\n\nexport const enum Constraint {\n  NONE = 0,\n  // Rowid alias\n  PRIMARY_KEY = 2,\n  UNIQUE = 4,\n  NOT_NULL = 8,\n}\n\nexport interface Field {\n  name: string;\n  type: FieldType;\n  constraints?: Constraint;\n}\n\nexport class Table {\n  private fieldNames: Set<string>;\n  private _fields: Field[];\n  public name: string;\n\n  constructor(tableName: string) {\n    this.name = tableName;\n    this.fieldNames = new Set();\n    this._fields = new Array();\n  }\n  addField(name: string, type: FieldType, constraints: Constraint = 0) {\n    if (this.fieldNames.has(name))\n      throw new Error(`table already has field ${name}`);\n    this._fields.push({ name, type, constraints });\n    this.fieldNames.add(name);\n    return this;\n  }\n  get fields(): Field[] {\n    return this._fields;\n  }\n  create(): string {\n    return \"\";\n  }\n  update(): string {\n    return \"\";\n  }\n  drop(): string {\n    return \"\";\n  }\n}\n\n// export class Migration {\n//   public id: string;\n//   private onUpCb?: CallableFunction;\n//   private onDownCb?: CallableFunction;\n//   constructor(id: string) {\n//     this.id = id;\n//   }\n//   up(cb: () => void) {\n//     this.onUpCb = cb;\n//     return this;\n//   }\n//   down(cb: () => void) {\n//     this.onDownCb = cb;\n//     return this;\n//   }\n//   get onUp() {\n//     return this.onUpCb;\n//   }\n// }\n\nexport interface Migration {\n  id: string;\n  up: () => string;\n  down: () => string;\n}\n\nclass MigrationManager {\n  private migrations: Map<string, Migration>;\n  constructor(migrations: Migration[]) {\n    this.migrations = new Map();\n    migrations.forEach((migration) => {\n      if (this.migrations.has(migration.id))\n        throw new Error(\"migrations cannot have same ID\");\n      this.migrations.set(migration.id, migration);\n    });\n  }\n}\n"],"mappings":";AAgBA,IAAa,QAAb,MAAmB;CACjB,AAAQ;CACR,AAAQ;CACR,AAAO;CAEP,YAAY,WAAmB;AAC7B,OAAK,OAAO;AACZ,OAAK,6BAAa,IAAI,KAAK;AAC3B,OAAK,UAAU,IAAI,OAAO;;CAE5B,SAAS,MAAc,MAAiB,cAA0B,GAAG;AACnE,MAAI,KAAK,WAAW,IAAI,KAAK,CAC3B,OAAM,IAAI,MAAM,2BAA2B,OAAO;AACpD,OAAK,QAAQ,KAAK;GAAE;GAAM;GAAM;GAAa,CAAC;AAC9C,OAAK,WAAW,IAAI,KAAK;AACzB,SAAO;;CAET,IAAI,SAAkB;AACpB,SAAO,KAAK;;CAEd,SAAiB;AACf,SAAO;;CAET,SAAiB;AACf,SAAO;;CAET,OAAe;AACb,SAAO"}